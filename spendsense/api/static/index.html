<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SpendSense Dashboard</title>
    <link rel="stylesheet" href="/static/styles.css">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <h1>üéØ SpendSense Dashboard</h1>
            <p class="subtitle">Synthetic Data Generation & Testing Platform</p>
        </header>

        <!-- Navigation -->
        <nav class="tabs">
            <button class="tab active" data-tab="generate">Generate Profiles</button>
            <button class="tab" data-tab="profiles">View Profiles</button>
            <button class="tab" data-tab="signals">Behavioral Signals</button>
            <button class="tab" data-tab="assignment">Persona Assignment</button>
            <button class="tab" data-tab="recommendations">üí° Recommendations</button>
            <button class="tab" data-tab="stats">Statistics</button>
            <button class="tab" data-tab="personas">Personas</button>
            <button class="tab" data-tab="future">Future Features</button>
        </nav>

        <!-- Generate Tab -->
        <div id="generate" class="tab-content active">
            <div class="card">
                <h2>Generate Synthetic User Profiles</h2>
                <p>Create realistic user profiles with persona-based financial characteristics.</p>

                <form id="generate-form" class="form">
                    <div class="form-group">
                        <label for="num-users">Number of Users (50-100)</label>
                        <input type="number" id="num-users" min="50" max="100" value="100" required>
                    </div>

                    <div class="form-group">
                        <label for="seed">Random Seed</label>
                        <input type="number" id="seed" value="42" required>
                        <small>Use the same seed for reproducible results</small>
                    </div>

                    <button type="submit" class="btn btn-primary">Generate Profiles</button>
                </form>

                <div id="generate-result" class="result hidden"></div>
            </div>
        </div>

        <!-- Profiles Tab -->
        <div id="profiles" class="tab-content">
            <div class="card">
                <div class="card-header">
                    <h2>User Profiles</h2>
                    <div class="filters">
                        <select id="persona-filter" class="select">
                            <option value="">All Personas</option>
                            <option value="high_utilization">High Utilization</option>
                            <option value="variable_income">Variable Income</option>
                            <option value="subscription_heavy">Subscription Heavy</option>
                            <option value="savings_builder">Savings Builder</option>
                            <option value="control">Control</option>
                        </select>
                        <button id="refresh-profiles" class="btn btn-secondary">Refresh</button>
                    </div>
                </div>

                <div id="profiles-list" class="profiles-list">
                    <p class="text-muted">Generate profiles to see them here...</p>
                </div>

                <div id="profile-pagination" class="pagination hidden"></div>
            </div>
        </div>

        <!-- Behavioral Signals Tab -->
        <div id="signals" class="tab-content">
            <div class="card">
                <h2>üîç Behavioral Signals Detection</h2>
                <p>Analyze user financial behavior patterns across multiple dimensions</p>

                <form id="signals-form" class="form">
                    <div class="form-group">
                        <label for="signals-user-id">User ID</label>
                        <input type="text" id="signals-user-id" placeholder="user_MASKED_000" required>
                    </div>

                    <div class="form-group">
                        <label for="signals-window">Time Window</label>
                        <select id="signals-window" class="select">
                            <option value="30">30 Days (Short-term)</option>
                            <option value="180" selected>180 Days (Long-term)</option>
                        </select>
                    </div>

                    <button type="submit" class="btn btn-primary">Analyze Signals</button>
                </form>

                <div id="signals-result" class="signals-dashboard hidden">
                    <!-- Will be populated by JavaScript -->
                </div>
            </div>
        </div>

        <!-- Persona Assignment Tab -->
        <div id="assignment" class="tab-content">
            <div class="card">
                <h2>üë§ Persona Assignment System</h2>
                <p>View persona assignments for users based on behavioral signals analysis</p>

                <form id="assignment-form" class="form">
                    <div class="form-group">
                        <label for="assignment-user-id">User ID</label>
                        <input type="text" id="assignment-user-id" placeholder="user_MASKED_000" required>
                    </div>

                    <div class="form-group">
                        <label for="assignment-window">Time Window</label>
                        <select id="assignment-window" class="select">
                            <option value="">Both Windows</option>
                            <option value="30d">30 Days (Short-term)</option>
                            <option value="180d">180 Days (Long-term)</option>
                        </select>
                    </div>

                    <button type="submit" class="btn btn-primary">Get Assignment</button>
                </form>

                <div id="assignment-result" class="assignment-dashboard hidden">
                    <!-- Will be populated by JavaScript -->
                </div>
            </div>
        </div>

        <!-- Stats Tab -->
        <div id="stats" class="tab-content">
            <div class="card">
                <h2>Profile Statistics</h2>
                <div id="stats-content">
                    <p class="text-muted">Generate profiles to see statistics...</p>
                </div>
            </div>
        </div>

        <!-- Personas Tab -->
        <div id="personas" class="tab-content">
            <div class="card">
                <h2>Persona Definitions</h2>
                <p>SpendSense uses 5 persona archetypes to generate realistic behavioral patterns:</p>
                <div id="personas-content" class="personas-grid"></div>
            </div>
        </div>

        <!-- Recommendations Tab (Epic 4) -->
        <div id="recommendations" class="tab-content">
            <div class="card">
                <h2>üí° Personalized Recommendations (Epic 4)</h2>
                <p>Generate personalized financial recommendations combining educational content and partner offers with transparent rationales.</p>

                <form id="recommendations-form" class="form">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="rec-user-id">User ID</label>
                            <input type="text" id="rec-user-id" placeholder="user_MASKED_000" required>
                        </div>

                        <div class="form-group">
                            <label for="rec-window">Time Window</label>
                            <select id="rec-window" class="select">
                                <option value="30d" selected>30 Days</option>
                                <option value="180d">180 Days</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label>
                                <input type="checkbox" id="rec-force-generate" checked>
                                Force Generate (ignore cache)
                            </label>
                        </div>
                    </div>

                    <button type="submit" class="btn btn-primary">Generate Recommendations</button>
                </form>

                <div id="recommendations-loading" class="loading hidden">
                    <div class="spinner"></div>
                    <p>Generating recommendations...</p>
                </div>

                <div id="recommendations-result" class="result hidden">
                    <!-- Summary Card -->
                    <div class="rec-summary card-header">
                        <h3>Recommendation Summary</h3>
                        <div class="rec-meta">
                            <span class="badge" id="rec-persona"></span>
                            <span class="badge badge-secondary" id="rec-window-badge"></span>
                            <span class="badge badge-success" id="rec-time"></span>
                        </div>
                    </div>

                    <!-- Mandatory Disclaimer -->
                    <div class="disclaimer-box">
                        <strong>‚ö†Ô∏è Disclaimer:</strong>
                        <p id="rec-disclaimer"></p>
                    </div>

                    <!-- Signals Detected -->
                    <div class="signals-box">
                        <h4>üîç Signals Detected</h4>
                        <div id="rec-signals"></div>
                    </div>

                    <!-- Recommendations List -->
                    <div class="recommendations-list">
                        <h3>Your Personalized Recommendations</h3>
                        <div id="rec-items"></div>
                    </div>

                    <!-- Metadata -->
                    <div class="metadata-box">
                        <h4>üìä Generation Metadata</h4>
                        <pre id="rec-metadata"></pre>
                    </div>
                </div>

                <div id="recommendations-error" class="error hidden"></div>
            </div>
        </div>

        <!-- Future Features Tab -->
        <div id="future" class="tab-content">
            <div class="card">
                <h2>Coming Soon</h2>
                <p>These features will be added in future stories:</p>

                <div class="feature-list">
                    <div class="feature-item">
                        <h3>üìä Story 1.4: Transaction Data</h3>
                        <p>Generate synthetic transactions based on user profiles and personas</p>
                        <span class="badge">Epic 1</span>
                    </div>

                    <div class="feature-item">
                        <h3>üîç Epic 2: Signal Detection</h3>
                        <p>Detect behavioral patterns like high utilization, variable income, etc.</p>
                        <span class="badge">Epic 2</span>
                    </div>

                    <div class="feature-item">
                        <h3>üë§ Epic 3: Persona Assignment</h3>
                        <p>Match users to personas based on detected signals</p>
                        <span class="badge">Epic 3</span>
                    </div>

                    <div class="feature-item">
                        <h3>üí° Epic 4: Recommendations</h3>
                        <p>Generate personalized financial recommendations</p>
                        <span class="badge">Epic 4</span>
                    </div>

                    <div class="feature-item">
                        <h3>üõ°Ô∏è Epic 5: Guardrails</h3>
                        <p>Consent management, eligibility filtering, tone validation</p>
                        <span class="badge">Epic 5</span>
                    </div>

                    <div class="feature-item">
                        <h3>üëÅÔ∏è Epic 6: Operator View</h3>
                        <p>Dashboard for oversight and approval workflows</p>
                        <span class="badge">Epic 6</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="footer">
            <p>SpendSense v1.0 | Built with FastAPI & Vanilla JS</p>
        </footer>
    </div>

    <script src="/static/app.js"></script>
</body>
</html>
